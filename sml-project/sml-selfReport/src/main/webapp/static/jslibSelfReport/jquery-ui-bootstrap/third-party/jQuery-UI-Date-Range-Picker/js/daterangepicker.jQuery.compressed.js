(function(b){b.fn.daterangepicker=function(y){var N=b(this);var M=b.extend({presetRanges:[{text:"Today",dateStart:"today",dateEnd:"today"},{text:"Last 7 days",dateStart:"today-7days",dateEnd:"today"},{text:"Month to date",dateStart:function(){return Date.parse("today").moveToFirstDayOfMonth()},dateEnd:"today"},{text:"Year to date",dateStart:function(){var c=Date.parse("today");c.setMonth(0);c.setDate(1);return c},dateEnd:"today"},{text:"The previous Month",dateStart:function(){return Date.parse("1 month ago").moveToFirstDayOfMonth()},dateEnd:function(){return Date.parse("1 month ago").moveToLastDayOfMonth()}}],presets:{specificDate:"Specific Date",allDatesBefore:"All Dates Before",allDatesAfter:"All Dates After",dateRange:"Date Range"},rangeStartTitle:"Start date",rangeEndTitle:"End date",nextLinkText:"Next",prevLinkText:"Prev",target:N,doneButtonText:"Done",earliestDate:Date.parse("-15years"),latestDate:Date.parse("+15years"),constrainDates:false,rangeSplitter:"-",dateFormat:"m/d/yy",closeOnSelect:true,arrows:false,appendTo:"body",onClose:function(){},onOpen:function(){},onChange:function(){},datepickerOptions:null},y);var K={onSelect:function(d,f){var h=H.find(".range-start");var g=H.find(".range-end");if(H.find(".ui-daterangepicker-specificDate").is(".ui-state-active")){g.datepicker("setDate",h.datepicker("getDate"))}b(this).trigger("constrainOtherPicker");var c=P(h.datepicker("getDate"));var e=P(g.datepicker("getDate"));if(N.length==2){N.eq(0).val(c);N.eq(1).val(e)}else{N.val((c!=e)?c+" "+M.rangeSplitter+" "+e:c)}if(M.closeOnSelect){if(!H.find("li.ui-state-active").is(".ui-daterangepicker-dateRange")&&!H.is(":animated")){G()}b(this).trigger("constrainOtherPicker");M.onChange()}},defaultDate:+0};N.bind("change",M.onChange);M.datepickerOptions=(y)?b.extend(K,y.datepickerOptions):K;var E,F=Date.parse("today");var C,I;if(N.size()==2){C=Date.parse(N.eq(0).val());I=Date.parse(N.eq(1).val());if(C==null){C=I}if(I==null){I=C}}else{C=Date.parse(N.val().split(M.rangeSplitter)[0]);I=Date.parse(N.val().split(M.rangeSplitter)[1]);if(I==null){I=C}}if(C!=null){E=C}if(I!=null){F=I}var H=b('<div class="ui-daterangepicker ui-widget ui-helper-clearfix ui-widget-content ui-corner-all"></div>');var w=(function(){var d=b('<ul class="ui-widget-content"></ul>').appendTo(H);b.each(M.presetRanges,function(){b('<li class="ui-daterangepicker-'+this.text.replace(/ /g,"")+' ui-corner-all"><a href="#">'+this.text+"</a></li>").data("dateStart",this.dateStart).data("dateEnd",this.dateEnd).appendTo(d)});var c=0;b.each(M.presets,function(e,f){b('<li class="ui-daterangepicker-'+e+" preset_"+c+' ui-helper-clearfix ui-corner-all"><span class="ui-icon ui-icon-triangle-1-e"></span><a href="#">'+f+"</a></li>").appendTo(d);c++});d.find("li").hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")}).click(function(){H.find(".ui-state-active").removeClass("ui-state-active");b(this).addClass("ui-state-active");A(b(this),H,D,L);return false});return d})();function P(g){if(!g.getDate()){return""}var d=g.getDate();var c=g.getMonth();var f=g.getFullYear();c++;var e=M.dateFormat;return b.datepicker.formatDate(e,g)}b.fn.restoreDateFromData=function(){if(b(this).data("saveDate")){b(this).datepicker("setDate",b(this).data("saveDate")).removeData("saveDate")}return this};b.fn.saveDateToData=function(){if(!b(this).data("saveDate")){b(this).data("saveDate",b(this).datepicker("getDate"))}return this};function x(){if(H.data("state")=="closed"){a();H.fadeIn(300).data("state","open");M.onOpen()}}function G(){if(H.data("state")=="open"){H.fadeOut(300).data("state","closed");M.onClose()}}function O(){if(H.data("state")=="open"){G()}else{x()}}function a(){var e=B||N;var d=e.offset(),g="left",f=d.left,c=b(window).width()-f-e.outerWidth();if(f>c){g="right",f=c}H.parent().css(g,f).css("top",d.top+e.outerHeight())}function A(f,h,d,e){if(f.is(".ui-daterangepicker-specificDate")){e.hide();d.show();h.find(".title-start").text(M.presets.specificDate);h.find(".range-start").restoreDateFromData().css("opacity",1).show(400);h.find(".range-end").restoreDateFromData().css("opacity",0).hide(400);setTimeout(function(){e.fadeIn()},400)}else{if(f.is(".ui-daterangepicker-allDatesBefore")){e.hide();d.show();h.find(".title-end").text(M.presets.allDatesBefore);h.find(".range-start").saveDateToData().datepicker("setDate",M.earliestDate).css("opacity",0).hide(400);h.find(".range-end").restoreDateFromData().css("opacity",1).show(400);setTimeout(function(){e.fadeIn()},400)}else{if(f.is(".ui-daterangepicker-allDatesAfter")){e.hide();d.show();h.find(".title-start").text(M.presets.allDatesAfter);h.find(".range-start").restoreDateFromData().css("opacity",1).show(400);h.find(".range-end").saveDateToData().datepicker("setDate",M.latestDate).css("opacity",0).hide(400);setTimeout(function(){e.fadeIn()},400)}else{if(f.is(".ui-daterangepicker-dateRange")){e.hide();d.show();h.find(".title-start").text(M.rangeStartTitle);h.find(".title-end").text(M.rangeEndTitle);h.find(".range-start").restoreDateFromData().css("opacity",1).show(400);h.find(".range-end").restoreDateFromData().css("opacity",1).show(400);setTimeout(function(){e.fadeIn()},400)}else{e.hide();h.find(".range-start, .range-end").css("opacity",0).hide(400,function(){d.hide()});var g=(typeof f.data("dateStart")=="string")?Date.parse(f.data("dateStart")):f.data("dateStart")();var c=(typeof f.data("dateEnd")=="string")?Date.parse(f.data("dateEnd")):f.data("dateEnd")();h.find(".range-start").datepicker("setDate",g).find(".ui-datepicker-current-day").trigger("click");h.find(".range-end").datepicker("setDate",c).find(".ui-datepicker-current-day").trigger("click")}}}}return false}var D=b('<div class="ranges ui-widget-header ui-corner-all ui-helper-clearfix"><div class="range-start"><span class="title-start">Start Date</span></div><div class="range-end"><span class="title-end">End Date</span></div></div>').appendTo(H);D.find(".range-start, .range-end").datepicker(M.datepickerOptions);D.find(".range-start").datepicker("setDate",E);D.find(".range-end").datepicker("setDate",F);D.find(".range-start, .range-end").bind("constrainOtherPicker",function(){if(M.constrainDates){if(b(this).is(".range-start")){H.find(".range-end").datepicker("option","minDate",b(this).datepicker("getDate"))}else{H.find(".range-start").datepicker("option","maxDate",b(this).datepicker("getDate"))}}}).trigger("constrainOtherPicker");var L=b('<button class="btnDone ui-state-default ui-corner-all">'+M.doneButtonText+"</button>").click(function(){H.find(".ui-datepicker-current-day").trigger("click");G()}).hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")}).appendTo(D);b(this).click(function(){O();return false});D.hide().find(".range-start, .range-end, .btnDone").hide();H.data("state","closed");D.find(".ui-datepicker").css("display","block");b(M.appendTo).append(H);H.wrap('<div class="ui-daterangepickercontain"></div>');if(M.arrows&&N.size()==1){var J=b('<a href="#" class="ui-daterangepicker-prev ui-corner-all" title="'+M.prevLinkText+'"><span class="ui-icon ui-icon-circle-triangle-w">'+M.prevLinkText+"</span></a>");var z=b('<a href="#" class="ui-daterangepicker-next ui-corner-all" title="'+M.nextLinkText+'"><span class="ui-icon ui-icon-circle-triangle-e">'+M.nextLinkText+"</span></a>");b(this).addClass("ui-rangepicker-input ui-widget-content").wrap('<div class="ui-daterangepicker-arrows ui-widget ui-widget-header ui-helper-clearfix ui-corner-all"></div>').before(J).before(z).parent().find("a").click(function(){var c=D.find(".range-start").datepicker("getDate");var d=D.find(".range-end").datepicker("getDate");var e=Math.abs(new TimeSpan(c-d).getTotalMilliseconds())+86400000;if(b(this).is(".ui-daterangepicker-prev")){e=-e}D.find(".range-start, .range-end ").each(function(){var f=b(this).datepicker("getDate");if(f==null){return false}b(this).datepicker("setDate",f.add({milliseconds:e})).find(".ui-datepicker-current-day").trigger("click")});return false}).hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")});var B=N.parent()}b(document).click(function(){if(H.is(":visible")){G()}});H.click(function(){return false}).hide();return this}})(jQuery);